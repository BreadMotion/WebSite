---
title: RClone Operation Flow
date: 2025-11-20
category: CloudStorage
description: Explains how to efficiently manage large-scale assets and achieve CI/CD integration using rclone and shell scripts in a project.
tags: [tool, cloudstorage, git]
thumbnail: https://images.icon-icons.com/2699/PNG/512/rclone_logo_icon_169806.png
---

Hello! I'm PanKUN.

In the previous article, I explained the introduction flow of rclone in a Windows environment and its linkage with Google Drive.
This time, as a continuation, I will introduce an operational technique combining rclone and shell scripts for the specific issue of **large-scale asset management in projects**.

I will explore practical approaches to solve capacity limits and performance issues that often occur in Git LFS operations, and to smooth asset management efficiency and CI/CD integration in team development.

## Goal of this article

- Efficiently manage large-scale assets (models, textures, sounds, etc.) of a project with rclone.
- Automate the coordination between Git and rclone using the following custom shell scripts.
    - `Aup.sh`: Asset upload
    - `Adown.sh`: Asset download
    - `Alock.sh`: Asset lock
    - `Aunlock.sh`: Asset unlock
- Grasp the image of automatic asset synchronization and build integration in the CI/CD pipeline.

## Challenges of Large-Scale Asset Management and Advantages of rclone

In game development, large-scale assets such as 3D models, high-resolution textures, and long sound files often appear in units of GB.
Directly managing these with Git tends to bloat the repository, causing problems such as slow cloning and fetching, or hitting the capacity limit of Git LFS.

By linking rclone with external storage (such as Google Drive), it becomes possible to separate these large assets from the Git repository and manage them efficiently.
Git manages only references to assets, and actual data is stored in external storage via rclone, realizing a lightweight and high-speed repository.

## RClone Operation Strategy in UE

Prepare `Tool` in the root directory of UE and prepare 4 shell scripts. (It should be fine to replace them with batch files and adjust the commands)
- `Aup.sh`
- `Adown.sh`
- `Alock.sh`
- `Aunlock.sh`

These scripts wrap rclone commands targeting prefixes that can be large files under the `Assets` directory and automate asset synchronization and locking.
(If you want to target extensions other than .uasset, add a judgment)

### 1. `Aup.sh`: Asset Upload

`Aup.sh` is used to upload local project assets to Google Drive (or the configured remote storage).
This is an image executed when asset editing is complete and ready for sharing.

**Usage Example:**
```sh
# Execute at the root directory of the Unity project
sh ./Tool/Aup.sh
```

**Overview of internal processing:**
1. Scan files under the `Content` directory.
2. Upload each file to remote storage with the rclone command.
3. Commit placeholder files (or path information only) of the uploaded assets to the Git repository.

### 2. `Adown.sh`: Asset Download

`Adown.sh` is used to download assets on remote storage to the local project.
Execute this when team members clone the project or want to update to the latest assets.

**Usage Example:**
```sh
# Execute at the root directory of the project
sh ./Tool/Adown.sh
```

**Overview of internal processing:**
1. Get asset reference information in the Git repository.
2. Download corresponding asset files from remote storage to the `Content` directory using the rclone command.
3. Adjust downloaded assets so they are recognized by the editor (if necessary).

### 3. `Alock.sh`: Asset Lock

The locking mechanism is very important to prevent conflicts due to simultaneous editing of large assets.
`Alock.sh` locks specific assets so that other members cannot edit them at the same time.

**Usage Example:**
```sh
# Execute at the root directory of the UE project
sh ./Tool/Alock.sh Content/Model/SK_ModelX.uasset
```

**Overview of internal processing:**
1. Register lock information of the specified asset to remote storage or a dedicated lock management system.
2. Reflect the lock state in the Git repository as well.
3. Notify that the lock was successful. Display an error message if already locked.

### 4. `Aunlock.sh`: Asset Unlock

When asset editing is complete and uploading with `Aup.sh` is done, use `Aunlock.sh` to release the lock.

**Usage Example:**
```sh
# Execute at the root directory of the project
sh ./Tool/Aunlock.sh Content/Model/SK_ModelX.uasset
```

**Overview of internal processing:**
1. Release lock information of the specified asset from remote storage or lock management system.
2. Update the lock state of the Git repository.
3. Notify that unlock was successful. Display an error message if the file is not locked or locked by another user.

## Integration with CI/CD Pipeline

These scripts can be easily incorporated into the CI/CD pipeline.

**Example of automatic synchronization on build server:**
1. When CI is triggered, first fetch the repository with `git clone`.
2. Next, execute `./Tool/Adown.sh` to automatically download necessary assets.
3. Execute command line build.

This allows the build server to always execute builds with the latest code and assets, saving the trouble of manual asset synchronization.

## Image referencing `MMD_rclone.png` (Virtual Diagram)

The previous RClone introduction flowchart (`MMD_rclone.png`) was the setting flow of RClone itself,
but the flow of assets in this operational technique looks like the following image.

The final version of the flowchart is [here](https://breadmotion.github.io/WebSite/content/other/Rclone2.html).
![RClone Introduction Flowchart](https://breadmotion.github.io/WebSite/assets/img/MMD_rclone2.png)

## Importance of Lock/Unlock (`Alock.sh` / `Aunlock.sh`)

When multiple people edit at the same time, unintended overwrites and conflicts are problems to avoid.
Like the file locking function of Git LFS, this locking mechanism becomes very important in asset management using `rclone`. `Alock.sh` and `Aunlock.sh` are custom shell scripts for that purpose.

### `Alock.sh`: Asset Lock

`Alock.sh` marks the specified asset file as "locked" on remote storage.
This prevents other developers from editing the same file at the same time and significantly reduces the risk of conflict occurrence.

**Main functions:**

- Receive the path of the specified asset.
- Use rclone's lock function (or external lock management system) to lock the file on remote storage.
- Notify if the lock is successful.
- If it is already locked by another user, display that information and refuse the lock.

**Operation Image:**
Before a developer starts editing a specific asset, execute `Alock.sh Content/Model/SK_ModelA.uasset`.
If the lock is successful, you can proceed with the work with peace of mind.

### `Aunlock.sh`: Asset Unlock

When asset editing and uploading to remote storage with `Aup.sh` is done, use `Aunlock.sh` to release the lock.
This allows other developers to lock and edit that asset.

**Main functions:**

- Receive the path of the specified asset.
- Release the lock of the file on remote storage.
- Notify if the unlock is successful.
- Notify an error if attempting to unlock a file that is not locked or locked by a user other than yourself.

**Operation Image:**
When asset editing and uploading are finished, execute `Aunlock.sh Content/Model/SK_ModelA.uasset` to release the lock.
This allows other team members to get the latest version of that asset and, if necessary, lock and start editing.

### Merits of Lock Mechanism

- **Prevention of conflicts**: Can avoid complex merge work of large assets.
- **Clear scope of responsibility**: You can see at a glance who is editing which asset, preventing useless work duplication.
- **Efficiency of team development**: Smooth asset coordination improves the productivity of the entire development.

By properly operating these scripts and flows, asset management of projects combining Git and rclone will become more robust and efficient.

## Summary

Asset management in projects is an important issue that greatly affects the efficiency of team development.
By combining rclone with custom shell scripts `Aup.sh`, `Adown.sh`, `Alock.sh`, `Aunlock.sh`, it becomes possible to keep the Git repository lightweight while efficiently managing large assets in external storage, and further smooth integration with the CI/CD pipeline.

By introducing this operational technique, developers will be able to concentrate on content creation and development without being bothered by asset capacity or Git LFS limits.
