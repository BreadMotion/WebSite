---
title: UE5プラグイン開発
date: 2025-10-09
category: UE5
description: ゲーム開発におけるUE5のプラグイン開発
tags: ue5, cpp
thumbnail: assets/images/blog/unreal-engine.png
---

こんにちは！パン君です

今回はUE5のゲーム開発を行う際に気にしておくと、次回プロジェクト以降に便利になるプラグイン化についてです。

---

## 概要

ゲームのとある機能を作成する際に責任の粒度を気にしながら作成をすると下記のようなメリットがあります。

- メンテナンス性
  機能がひとまとまりになっているので、バグ修正や仕様変更の影響範囲を把握しやすい。
- 可読性
  「この機能はこのプラグインを見ればいい」が明確になり、プロジェクト全体の見通しがよくなる。
- 再利用性
別プロジェクトに持っていくとき、**プラグインごとコピペ or 依存追加**で済む。
- チーム開発との相性
  役割分担がしやすく、担当ごとにモジュール境界を引きやすい。

この記事では、**「プラグインとして切り出す時にどこを意識するとおいしいか」**にフォーカスしてまとめます。

---

## プラグイン化を意識するタイミング

個人的に次のどれかに当てはまったら「プラグインにしておく候補」として一度立ち止まるようにしています。

- 今後も別プロジェクトで使いまわしそうな機能
- 「ゲーム固有のロジック」と「共通の仕組み」が混ざり始めた時
- Editor拡張やツールなど「ゲーム実行とは独立した機能」のとき　

また**全てをプラグイン推奨、という話ではなく**
**「プロジェクトを跨いでも生き残ってほしい機能」**は最初からプラグインとして分けておくと後で得をしやすいという話です。

---

## 責任の粒度をどう決めるか

責任の粒度を決めるときに自分がよく使う目安はこんな感じです。

### 1. １フレーズで説明できるか

プラグインの説明が１フレーズで表現できるかどうか

- OK例：  
  - このプラグインは **ゲーム内のセーブ/ロード管理** を担当する  
  - このプラグインは **カメラの追従・揺れ・ズームの制御** をまとめたもの
- NG例：  
  - セーブもするし、UIも出すし、エネミーのパラメータもいじるやつ

### 2. ゲーム依存の部分をどう切り離すか

プラグイン側のコードの中に

- プロジェクト固有のGameMode名
- 特定のキャラクタークラス
- 特定のマップ名

などが直書きされてくると**再利用性が一気に落ちます**。

なので、

- プラグイン側: 抽象的なインターフェース・イベントを定義
- ゲーム側: それを実装して「具体的な処理」を書く

---

## プラグインを作るときの手順

細かいボタンの一はUEのバージョンで多少変わりますが、流れとしては下記のような感じです。

1. UE5 Editor で  
   `Plugins` → 「New Plugin」からテンプレートを選ぶ  
   - Runtime Plugin / Editor Plugin など用途に合わせて選択
2. プロジェクトの `Plugins/YourPluginName/` に C++ / BP が生成される
3. プラグインの `.uplugin` に
   - モジュール種別（Runtime / Editor）
   - 依存モジュール
   を記述
4. C++ の場合は、`YourPluginNameModule` クラスの `StartupModule` / `ShutdownModule` で初期化・解放処理を書く
5. あとは「通常のプロジェクトコードと同じ感覚で」機能を組む  
   ただし、**ゲーム固有の名前にべったり依存しないように注意**

最初から完璧な設計を目指す必要はなくて、まずは
1. 「この固まりはplugインとして独立できそうだな」位の粒度で箱を作る
2. 使ってみて気になったところを**少しずつインターフェース化していく**と
自然に「いい感じの責務の境界」が見えてきます。

---

## プラグイン化でやりがちな失敗例

自分がハマった/見かけたパターンをいくつか挙げておきます。

### 1. なんでも間でも１つのプラグインに突っ込む

1フレーズで説明できなくなったら、プラグインを分割するタイミングだと思った方が楽です。

- 「共通系」という名前のプラグインに
  - セーブ/ロード
  - UI共通部品
  - デバッグ用コンソール
  - ネットワークラッパー
  を全部入れた結果、**ただの巨大プロジェクト**になってしまうパターン

### 2. ゲーム固有クラスを直書きしてしまう

- プラグインのコード内で  
  `AMyGameCharacter` や `AMyGameGameMode` を直接参照
- 次のプロジェクトに持っていった瞬間、**全コンパイルエラー**

インターフェース（`UInterface` や Delegates）を噛ませて下記のようにしておくと移植性が段違いに上がります。

- 「プラグインが欲しい情報」をイベントや関数で外から供給してもらう  
- プラグイン自体は「誰かがこれを実装してくれる」という前提で動く

---

## まとめ

- UE5 でゲームを作るとき、**「次のプロジェクトでも使いたい機能」** は最初からプラグインとして箱を分けておくと後が楽
- 責任の粒度は
  - 1フレーズで説明できるか
  - ゲーム固有の部分と切り離せているか
  を基準に考えると整理しやすい
- いきなり完璧に作る必要はなくて、
  - まずは「この機能はプラグインにしておこう」
  - 使いながら境界やインターフェースを整える
  くらいのノリが現実的
